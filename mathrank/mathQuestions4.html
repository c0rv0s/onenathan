<!DOCTYPE html>
<html>
<head>
	<title>MathRank</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" href="style.css" />
	<!--<link rel="stylesheet" href="star.css" />-->
	<!-- Favicons AND TOUCH ICONS   -->
	<link rel="icon" href="logo32.ico">
	<link rel="apple-touch-icon" href="logo32.png">
	<link rel="apple-touch-icon" sizes="72x72" href="logo.png">
	<link rel="apple-touch-icon" sizes="114x114" href="logo114.png">

	<link rel='stylesheet' href='bootstrap.min.css'>
	<link rel='stylesheet' href='vendor.css'>
	<link rel='stylesheet' href='custom.css'> <!-- custom style -->
	<script src="jquery-1.12.2.min.js"></script>
	<script src="main.js"></script>
	<script src="https://sdk.amazonaws.com/js/aws-sdk-2.3.17.min.js"></script>
	<script src="https://apis.google.com/js/platform.js" async defer></script>
</head>

<!--HEADER-->
<header class="site-header text-light">
	<div class="site-header-container container">
		<div class="site-header-brand">
			<a href="index.html">
			<img class="site-header-brand-img" src="logo.png" alt="">
		</div> <!-- .site-header-brand -->

		<nav class="site-header-nav">
			<div class="primary-menu">
				<ul class="primary-menu-list nav">
					<li class="primary-menu-item">
						<a href="index.html"><span></span></a>
					</li>
					<li class="primary-menu-item">
						<a href="index.html"><span>Home</span></a>
					</li>
					<li class="primary-menu-item">
						<a href="help.html"><span>Help</span></a>
					</li>
					<li class="primary-menu-item">
						<a href="contact.html"><span>Contact</span></a>
					</li>
					<!--
					<li class="primary-menu-item">
						<a href="#download"><span>Account</span></a>
					</li>
				-->
				</ul>
			</div> <!-- .primary-menu -->

		</nav> <!-- .site-header-nav -->
	</div>
</header> <!-- .site-header -->

<!--BODY-->
<body>
	<canvas id="myCanvas"height="250" >
	Your browser does not support the HTML5 canvas tag.
	</canvas>
	<div class ="center-box">
<div>

	<div id="login">
		<p id="question">Click "Start!" to begin</p>
		<p id="instruction">Enter your answer (round down to the nearest integer) <br> ex: 10 / 3 = 3 <br><br></p>
		<input type="text" id="answerField"><br>

		<input id="clickMe" class="clickMe" type="button" value="Start!" onclick="mathQuestions(this);" />
		<!-- question script-->

		<script type="text/javascript">
		var score = 0;

		var numOne = 2;
		var numTwo = 2;
		var deadline = new Date(Date.parse(new Date()) + 2 * 60 * 1000);

		(function() {
			'use strict';

			var canvas = document.querySelector('canvas'),
					ctx = canvas.getContext('2d'),
					W = canvas.width = window.innerWidth,
					H = canvas.height = 250,
					maxP = 350,
					minP = 100,
					fireworks = [];
		})();

		(function() {
		  document.querySelector('input').addEventListener('keydown', function(e) {
		    if (e.keyCode === 13) {
		      // do whatever you want with the value
					var button1 = document.getElementById('clickMe');
					mathQuestions(button1);
		      console.log(this.value);
		    }
		  });
		})();

		function mathQuestions(elementClicked) {
			console.log(elementClicked);

			var button1 = document.getElementById('clickMe');
			var buttonVal = document.getElementById('clickMe').value;
			var answer = document.getElementById('answerField').value;

			if (elementClicked == button1) {
				// button 1 was clicked

				if (buttonVal == "Start!") {
					numOne = getRandomInt(50, 2000);
					numTwo = getRandomInt(1, 50);
					var newText = numOne.toString() + " / " + numTwo.toString() + " = ";
					document.getElementById('question').innerHTML = newText;
					button1.value = "Grade";
					deadline = new Date(Date.parse(new Date()) + 2 * 60 * 1000);
					initializeClock('clockdiv', deadline);
				}
				else {
					if (answer == Math.floor(numOne / numTwo)) {
						score += 10;
						numOne = getRandomInt(50, 2000);
						numTwo = getRandomInt(1, 50);
						triggerFireworks();
						var newText = numOne.toString() + " / " + numTwo.toString() + " = ";
						document.getElementById('question').innerHTML = newText;
					}
				}


			}
			document.getElementById("answerField").value = "";
		}

function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

		/* fireworks */
function triggerFireworks() {

	'use strict';

	var canvas = document.querySelector('canvas'),
			ctx = canvas.getContext('2d'),
			W = canvas.width = window.innerWidth,
			H = canvas.height = 250,
			maxP = 350,
			minP = 100,
			fireworks = [];

  function tick() {
    var newFireworks = [];
    ctx.clearRect(0, 0, W, H);

    fireworks.forEach(function (firework) {
      firework.draw();
      if (!firework.done) newFireworks.push(firework);
    });

    fireworks = newFireworks;
    window.requestAnimationFrame(tick);
  }

  function Vector(x, y) {
    this.x = x;
    this.y = y;
  }

  Vector.prototype = {
    constructor: Vector,

    add: function (vector) {
      this.x += vector.x;
      this.y += vector.y;
    },

    diff: function (vector) {
      var target = this.copy();
      return Math.sqrt(
        (target.x-=vector.x) * target.x + (target.y-=vector.y) * target.y
      );
    },

    copy: function () {
      return new Vector(this.x, this.y);
    }
  };

  var colors = [
    ['rgba(179,255,129,', 'rgba(0,255,0,'], //green / white
    ['rgba(0,0,255,', 'rgba(100,217,255,'], //blue / cyan
    ['rgba(255,0,0,', 'rgba(255,255,0,'], //red / yellow
    ['rgba(145,0,213,', 'rgba(251,144,204,'] //purple / pink
  ];

  function Firework(start, target, speed) {
    this.start = start;
    this.pos = this.start.copy();
    this.target = target;
    this.spread = Math.round(Math.random() * (maxP-minP)) + minP;
    this.distance = target.diff(start);
    this.speed = speed || Math.random() * 5 + 15;
    this.angle = Math.atan2(target.y - start.y, target.x - start.x);
    this.velocity = new Vector(
      Math.cos(this.angle) * this.speed,
      Math.sin(this.angle) * this.speed
    );

    this.particals = [];
    this.prevPositions = [];

    var colorSet = colors[Math.round(Math.random() * (colors.length -1))];

    for (var i=0; i<this.spread; i++) {
      this.particals.push(new Partical(target.copy(), colorSet));
    }
  }

  Firework.prototype = {
    constructor: Firework,

    draw: function () {
      var last = this.prevPositions[this.prevPositions.length -1] || this.pos;

      ctx.beginPath();
      ctx.moveTo(last.x, last.y);
      ctx.lineTo(this.pos.x, this.pos.y);
      ctx.strokeStyle = 'rgba(255,255,255,.7)';
      ctx.stroke();

      this.update();
    },

    update: function () {
      if (this.start.diff(this.pos) >= this.distance) {
        var newParticals = [];
        this.particals.forEach(function (partical) {
          partical.draw();
          if (!partical.done) newParticals.push(partical);
        });

        this.particals = newParticals;
        this.prevPositions = [];

        if (!newParticals.length) this.done = true;
      } else {
        this.prevPositions.push(this.pos.copy());

        if (this.prevPositions.length > 8) {
          this.prevPositions.shift();
        }

        this.pos.add(this.velocity);
      }
    }
  };

  function Partical(pos, colors) {
    this.pos = pos;
    this.ease = 0.2;
    this.speed = Math.random() * 6 + 2;
    this.gravity = Math.random() * 3 + 0.1;
    this.alpha = .8;
    this.angle = Math.random() * (Math.PI*2);
    this.color = colors[Math.round(Math.random() * (colors.length - 1))];
    this.prevPositions = [];
  }

  Partical.prototype = {
    constructor: Partical,

    draw: function () {
      var last = this.prevPositions[this.prevPositions.length -1] || this.pos;

      ctx.beginPath();
      ctx.moveTo(last.x, last.y);
      ctx.lineTo(this.pos.x, this.pos.y);
      ctx.strokeStyle = this.color + this.alpha + ')';
      ctx.stroke();

      this.update();
    },

    update: function () {
      if (this.alpha <= 0) {
        this.done = true;
      } else {
        this.prevPositions.push(this.pos.copy());

        if (this.prevPositions.length > 10) this.prevPositions.shift();
        if (this.speed > 1) this.speed -= this.ease;

        this.alpha -= 0.02;
        this.gravity += 0.01;

        this.pos.add({
          x: Math.cos(this.angle) * this.speed,
          y: Math.sin(this.angle) * this.speed + this.gravity
        });
      }
    }
  };

  function addFirework(target) {
    var startPos = new Vector(W/2, H);
    target = target || new Vector(Math.random() * W, Math.random() * (H - 125));
    fireworks.push(new Firework(startPos, target));
  }
/*
  canvas.addEventListener('click', function (e) {
    addFirework(new Vector(e.clientX, e.clientY))
  }, false);
	*/

  function randomFirework() {

		for (var i=0; i<20; i++) {
      addFirework();
    }

  }

  tick();
  randomFirework();

};
/*end fireworks */
/* clock */
	function getTimeRemaining(endtime) {
		var t = Date.parse(endtime) - Date.parse(new Date());
		var seconds = Math.floor((t / 1000) % 60);
		var minutes = Math.floor((t / 1000 / 60) % 60);
		return {
			'total': t,
			'minutes': minutes,
			'seconds': seconds
		};
	}

	function initializeClock(id, endtime) {
		var clock = document.getElementById(id);
		var minutesSpan = clock.querySelector('.minutes');
		var secondsSpan = clock.querySelector('.seconds');

		function updateClock() {
			var t = getTimeRemaining(endtime);
			minutesSpan.innerHTML = ('0' + t.minutes).slice(-2);
			secondsSpan.innerHTML = ('0' + t.seconds).slice(-2);

			if (t.total <= 0) {
					window.alert("Phase complete! \n\n Final Score: " + score);
				clearInterval(timeinterval);
				var newText = "Enter a starting set: ";
				document.getElementById('question').innerHTML = newText;
				var button1 = document.getElementById('clickMe');
				button1.value = "Start!";
			}
	}

	updateClock();
		var timeinterval = setInterval(updateClock, 1000);
	}



		</script>

	</div>
<div id="clockdiv">
  <div>
    <span class="minutes"></span>
    <div class="smalltext">Minutes</div>
  </div>
  <div>
    <span class="seconds"></span>
    <div class="smalltext">Seconds</div>
  </div>
	<script type="javascript">


	</script>
</div>


</div>

</body>

<!-- Footer -->
<footer id="footer">
		<p>&copy; Nathan Mueller. All rights reserved. <a href="http://onenathan.zone">ONENATHAN</a>.</p>
</footer>
</html>
